<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IM@S STATISTICS</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="stylesheet" href="css/bg.css">
    <style>
        #legend {
            width: fit-content;
            text-align: center;
            margin: 10px auto 30px;
            padding: 0 10px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            background: #ffffffe0;
            border-radius: 4px;
            user-select: none;
        }

        #legend1:hover {
            width: 70px;
            background: #f34f6d;
            box-shadow: 0 0 12px #f34f6d;
        }

        #legend2:hover {
            width: 44px;
            background: #2681c8;
            box-shadow: 0 0 12px #2681c8;
        }

        #legend3:hover {
            width: 43px;
            background: #ffc30b;
            box-shadow: 0 0 12px #ffc30b;
        }

        #legend4:hover {
            width: 66px;
            background: #0fbe94;
            box-shadow: 0 0 12px #0fbe94;
        }

        #legend5:hover {
            width: 42px;
            background: #8dbbff;
            box-shadow: 0 0 12px #8dbbff;
        }

        #legend6:hover {
            width: 43px;
            background: #f39800;
            box-shadow: 0 0 12px #f39800;
        }

        #legend7:hover {
            width: 71px;
            background: #656a75;
            box-shadow: 0 0 12px #656a75;
        }

        #legend8:hover {
            width: 180px;
            background: #ff74b8;
            box-shadow: 0 0 12px #ff74b8;
        }

        .legend-item {
            color: #000;
            display: inline-block;
            margin: 10px;
        }

        .legend-item:hover {
            color: #fefefe;
            border-radius: 4px;
            padding: 4px 6px;
            transition: 0.4s ease-in-out;
        }

        .legend-item:hover .legend-color {
            display: none;
        }

        .legend-color {
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 4px;
            position: relative;
            top: -2px;
            vertical-align: middle;
        }

        #chartWrapper {
            width: 1180px;
            margin: 0 auto 40px;
            background: #ffffffe0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        #barChart {
            width: 1000px;
            height: 600px;
        }

        #distChart {
            width: 960px;
            height: 600px;
        }

        #modeToggle {
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 160px;
            padding: 20px 0 10px;
        }

        #modeToggle button,
        #barChartStaticBtns button,
        #barChartBtns button,
        #prodBtns button,
        #distBtns button {
            width: 100px;
            padding: 10px;
            background: transparent;
            border: none;
            border-radius: 4px;
            font-family: 'font-title';
            font-size: 16px;
            cursor: pointer;
            transition: 0.4s ease-in-out;
            user-select: none;
        }

        #valueMode {
            display: block;
        }

        #ratioMode {
            display: none;
        }

        #pieChartContainer,
        #barChartContainer {
            display: flex;
            width: 100%;
        }

        #barChartBtns,
        #barChartStaticBtns,
        #prodBtns,
        #distBtns {
            display: flex;
            flex-direction: column;
            align-self: center;
        }

        #barChartBtns,
        #distBtns {
            padding-left: 20px;
        }

        #barChartBtns {
            gap: 36px;
        }

        #prodBtns {
            gap: 30px;
        }

        #distBtns {
            gap: 20px;
            padding-right: 40px;
        }

        #barChartStaticBtns {
            gap: 160px;
        }

        #barChartStaticBtns button,
        #distBtns button {
            width: 40px;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #barChartStaticBtns button {
            height: 100px;
        }

        #distBtns button {
            height: 90px;
        }

        #pieChartContainer #prodBtns button {
            width: 90px;
        }

        #modeToggle button:hover,
        #modeToggle button.active {
            background: #e22b30;
            color: #fefefe;
            box-shadow: 0 0 12px #e22b30;
        }

        #barChartBtns button:hover,
        #barChartBtns button.active,
        #distBtns button:hover,
        #distBtns button.active {
            background: #6699ff;
            color: #fefefe;
            box-shadow: 0 0 12px #6699ff;
        }

        #barChartStaticBtns button:hover,
        #barChartStaticBtns button.active {
            background: #fec001;
            color: #fefefe;
            box-shadow: 0 0 12px #fec001;
        }

        #prodBtns button#pieBtnALL:hover,
        #prodBtns button#pieBtnALL.active {
            background: #ff74b8;
            color: #fefefe;
            box-shadow: 0 0 12px #ff74b8;
        }

        #prodBtns button#pieBtn765AS:hover,
        #prodBtns button#pieBtn765AS.active {
            background: #f34f6d;
            color: #fefefe;
            box-shadow: 0 0 12px #f34f6d;
        }

        #prodBtns button#pieBtnCG:hover,
        #prodBtns button#pieBtnCG.active {
            background: #2681c8;
            color: #fefefe;
            box-shadow: 0 0 12px #2681c8;
        }

        #prodBtns button#pieBtnML:hover,
        #prodBtns button#pieBtnML.active {
            background: #ffc30b;
            color: #fefefe;
            box-shadow: 0 0 12px #ffc30b;
        }

        #prodBtns button#pieBtnSideM:hover,
        #prodBtns button#pieBtnSideM.active {
            background: #0fbe94;
            color: #fefefe;
            box-shadow: 0 0 12px #0fbe94;
        }

        #prodBtns button#pieBtnSC:hover,
        #prodBtns button#pieBtnSC.active {
            background: #8dbbff;
            color: #fefefe;
            box-shadow: 0 0 12px #8dbbff;
        }

        #prodBtns button#pieBtnGK:hover,
        #prodBtns button#pieBtnGK.active {
            background: #f39800;
            color: #fefefe;
            box-shadow: 0 0 12px #f39800;
        }

        #prodBtns button#pieBtnOthers:hover,
        #prodBtns button#pieBtnOthers.active {
            background: #656a75;
            color: #fefefe;
            box-shadow: 0 0 12px #656a75;
        }
    </style>
</head>

<body>
    <div id="loading">
        <div id="load-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#f34e6c">
                <path
                    d="M31.54,14.47c1.39,.32,2.97,.1,3.63-.29,.31-.18,.42-.39,.33-.61-.14-.33-.85-.49-2.45-.56-3.93-.17-5.9-2.29-6.73-3.2,0,0-.27-.29-.27-.29l-.18-.2c-.77-.84-1.12-1.22-2.01-1.17-1.14,.06-1.77,1.75-2.32,3.24,0,0-.06,.16-.11,.3-.21-.32-1.69-2.67-1.69-2.67-.02-.04-.04-.11-.04-.19,0-.19,.13-.46,.67-.61,1.46-.39,2.48-1.1,2.58-1.81,.01-.06,.02-.11,.02-.17,.01-.76-.98-1.53-2.46-1.89-.99-.24-1.69-.28-2.26-.15t0,0c.24-.15,.62-.25,.87-.21,.58,.09,.81,.03,.89-.04,.07-.05,.07-.12,0-.21-.05-.06-.17-.11-.34-.15-.37-.07-.94-.03-1.2,.07-.28,.11-.48,.3-.57,.55h-.07c-.1-.27-.27-.44-.54-.55-.25-.1-.82-.14-1.19-.07-.18,.03-.29,.08-.34,.15-.03,.04-.04,.08-.04,.1,0,.04,.03,.08,.05,.09,.12,.1,.43,.11,.89,.05,.26-.04,.65,.1,.89,.26-.74-.15-1.9,.05-2.63,.34-.93,.37-1.65,1.05-1.88,1.55-.09,.21-.18,.37-.55,.45-.28-.14-.6-.16-.87-.05-.28,.12-.42,.35-.33,.55,.07,.15,.15,.28,.45,.43,.3,.15,.95,.21,1.39,.18,0,.03,.01,.06,.01,.06,.07,.14,.25,.25,.51,.38,.33,.17,.78,.21,1.23,.12,.03,.02,.22,.14,.22,.14,.4,.2,.96,.22,1.47,.07,.11,.12,.14,.24,.14,.34,0,.08-.03,.15-.04,.19,0,0-1.55,2.33-2.02,3.04-.09-.22-.18-.44-.24-.67,0,0-.16-.46-.16-.46-.5-1.49-.94-2.79-2.08-2.79-.91,0-1.29,.39-2.2,1.34l-.03,.03s-.28,.29-.28,.29c-.87,.91-2.89,3.02-6.83,3.2-1.6,.07-2.32,.23-2.47,.56-.1,.22,0,.43,.31,.61,.65,.39,2.22,.61,3.62,.29,.22-.04,.28-.02,.29-.01,0,0,.01,0,0,.03-.03,.07-.37,.27-1.25,.42-.71,.12-1.17,.34-1.3,.62-.1,.21,0,.44,.26,.62,.21,.15,.65,.25,1.17,.26,.45,0,1.61-.03,2.69-.68,0,0-.01,0-.02,0,.05-.02,.13-.06,.35-.18,.09-.04,.16-.05,.19-.03,.05,.03-.01,.21-.61,.6-.69,.46-.93,.84-.7,1.12,.2,.24,.9,.39,2.19,0,2.76-1.02,3.54-2.51,4.11-3.6,.34-.65,.58-1.11,1.12-1.17,.47-.05,.81,.47,.96,.93-1.65,2.38-2.34,3.18-2.8,3.71-.23,.26-.41,.47-.62,.78,0,.02-.36,.45-.98,.73-.03,.02-.05,.04-.05,.06,0,0,0,.01,0,.02,.01,.03,.06,.05,.11,.05h.26c.4,.02,.86,.04,1.32,.12,1.73,.31,2.54,.79,2.57,.81,.05,.03,.11,.07,.11,.11v.02s-.08,.07-.19,.09l-.23,.04c-.2,.03-.5,0-.67-.07,0,0-.02,0-.03,0l-.93-.24s-.45-.09-.45-.09c0,0-.08-.01-.08-.01-1.53-.21-2.42,.07-2.6,.43,0,0,0,.02,0,.02-.03,.05-.05,.11-.05,.16,0,.08,.03,.18,.11,.26,.25,.3,.93,.54,1.87,.67,0,0,.03,0,.03,0h.05s.48,.04,.48,.04c.02,0,1.11,0,1.11,0,.22-.02,.51,.03,.66,.11l.55,.29c.1,.05,.27,.19,.22,.32-.04,.12-.26,.21-.63,.27-.06,0-1.64,.21-3.24-.06-.43-.07-.87-.15-1.27-.25,0,0-.38-.11-.38-.11l-.35-.11c-1.22-.43-1.95-1-1.94-1.53v-.1s.02-.02,.02-.02c0,0,0,0,0-.01,0-.03-.03-.05-.07-.07-.05-.01-.11,0-.14,.02-.49,.33-.79,.69-.91,1.09-.03,.12-.05,.25-.06,.37-.02,1.41,2.13,2.72,5.01,3.04,1.83,.2,3.62,0,4.93-.59,.9-.4,1.47-.93,1.65-1.53,.03-.11,.05-.22,.05-.33,0-.54-.34-1.09-1.06-1.73,0,0-.26-.21-.26-.21-.26-.2-.46-.35-.45-.66,0-.13,.04-.28,.12-.48,0,0,.93-2.16,1.19-2.78,.58,.57,1.63,.9,2.29,.94,.25,0,.56-.07,.77-.12,.04-.01,.08-.03,.08-.06,0-.03-.01-.05-.05-.07l-.08-.03s-.03,0-.05,0h-.17c-.26,0-.58,0-.7-.11-.06-.05-.07-.11-.03-.18,.06-.11,.29-.12,.68-.12,.32,0,.48,0,.6-.06,.03-.01,.06-.02,.06-.05,0-.02,0-.03-.03-.05l-.09-.05c-.06-.02-.15-.02-.38-.01h-.14s-.15-.01-.15-.01c-.29,0-.55-.01-.61-.17,0-.02-.01-.04-.01-.06,0-.05,.03-.08,.05-.09,.11-.09,.33-.08,.53-.08h.13c.42-.02,.5-.04,.58-.12,0-.01,.02-.03,.02-.04v-.02s0-.05-.03-.06c-.03-.02-.06-.03-.1-.02h-.09s-.18,.01-.18,.01c0,0-.05,0-.05,0-.22,0-.5,.02-.66-.07-.09-.05-.13-.1-.13-.15v-.02s.04-.1,.22-.16c0,0,.24-.04,.24-.04,.18-.02,.27-.04,.3-.09,0,0,0-.02,0-.03,0-.02,0-.04-.03-.06-.03-.03-.11-.06-.41-.08-.01,0-.03,0-.04,0h-.02c-.58-.01-1.07-.17-1.58-.45,1.06-2.59,1.13-2.99,1.14-3.02,.15-.24,.29-.32,.57-.32h.03c.28,0,.42,.08,.57,.32,0,.1,.06,.44,1,2.96-.29,.2-.7,.34-1.05,.43-.04,0-.06,.03-.07,.05,0,0,0,.01,0,.02,0,.02,0,.03,.02,.04,.03,.03,.05,.06,.05,.1v.06c-.07,.12-.25,.15-.45,.17-.01,0-.16,.03-.16,.03-.01,0-.03,0-.04,.01h-.03s-.06,.05-.06,.07h0s0,.05,.02,.06h.01c.12,.08,.32,.07,.55,.07h.06s.16,0,.16,0c.18-.01,.32-.02,.39,.09,.01,.02,.02,.04,.02,.07,0,.06-.03,.12-.06,.14-.15,.15-.45,.16-.72,.17h-.13s-.29,.01-.29,.01c-.05,0-.09,.02-.1,.05-.02,.03,0,.06,.05,.08,.05,.03,.13,.04,.39,.05h.16s.11,.01,.11,.01c.18,0,.36-.01,.47,.02,.11,.04,.18,.09,.2,.16,.01,.06-.02,.11-.09,.15-.18,.1-.4,.09-.72,.09-.3,0-.39,0-.44,.02-.04,0-.08,.03-.09,.06,0,.03,0,.06,.04,.08,.06,.03,.17,.05,.54,.05,.14,0,.23,0,.28,.01,.08,.02,.15,.06,.2,.12,.03,.04,.1,.05,.16,.03,.53-.18,1.06-.42,1.35-.68,.12,.3,1.1,2.78,1.1,2.78,.08,.19,.11,.35,.11,.48,0,.22-.11,.35-.27,.49-.02,.01-.02,.03-.03,.05,0,.02,0,.04,.03,.05,.04,.03,.1,.03,.16,.01,.6-.23,1.3-.41,2.08-.53,1.72-.26,3.21,0,3.27,.02,.11,0,.17,.03,.18,.06,0,0,0,0,0,.01,0,.03-.03,.05-.08,.08,0,0-.4,.1-.4,.1-.02,0-.38,.13-.8,.09-.59-.05-1.04-.04-1.68,.05-.88,.12-1.53,.35-1.82,.64-.15,.15-.19,.3-.14,.45,.17,.46,1.42,.69,2.78,.53,.58-.07,1.39-.29,1.74-.57,.03-.03,.03-.06,.01-.09-.03-.03-.08-.04-.13-.04l-1.83,.19c-.21,.03-.41-.02-.45-.11l-.11-.29s0-.06,.03-.1c.06-.05,.17-.1,.3-.12,.02,0,1.95-.24,3.59-.31,.59-.03,.9,0,1.18,.19,.24,.17,.06,.46-.01,.58,0,0-.02,.04-.02,.04-.02,.06-.65,1.3-4.08,1.67-3.12,.34-4.69-.27-5.07-.89-.02-.03-.08-.05-.13-.05-.05,0-.1,.03-.1,.07l-.04,.3c0,.11,.01,.22,.04,.33,.16,.61,.71,1.14,1.6,1.53,1.29,.57,3.08,.79,4.91,.58,2.93-.33,5.08-1.64,5.1-3.04,0-.12-.02-.25-.04-.37-.27-1.02-1.72-1.8-3.97-2.13-1.05-.15-1.64-.91-1.66-.94-.21-.3-.38-.51-.59-.77-.46-.56-1.16-1.41-2.91-4.08,.13-.23,.41-.61,.82-.58,.54,.04,.75,.52,1.04,1.19,.5,1.15,1.18,2.72,4.05,3.58,1.29,.39,1.98,.24,2.19,0,.24-.28,0-.67-.66-1.12-.58-.39-.64-.57-.59-.6,.02-.02,.09-.01,.18,.03l.33,.18c1.06,.64,2.21,.69,2.66,.68,.52-.01,.96-.11,1.17-.26,.26-.18,.36-.41,.27-.62-.12-.28-.58-.5-1.28-.62-.87-.15-1.21-.35-1.23-.42,0-.02,0-.02,0-.03,.01,0,.07-.03,.29,.01m-13.58-7.73l.07,.07s-.03-.02-.03-.02c0,0,.02,.03,.05,.05-.01,.02-.01,.02-.02,.04-.03,.01-.06,.02-.09,0-.05-.02-.09-.06-.11-.09-.03-.03-.1-.05-.15-.04-.12,.03-.24,.05-.36,.06-.06,0-.11,.04-.11,.08,0,0,0,.02,0,.03,0,.01-.01,.02-.02,.04-.03,0-.03,0-.06,.02-.03,0-.07-.02-.07-.04,0,0,0-.03,0-.03,0,0,0-.02,0-.02,0-.03-.05-.07-.1-.08l-.3-.05s-.1,0-.13,.01c-.06,.03-.11,.06-.17,.08-.04,0-.07,0-.09-.02,0,0,0-.02,0-.03,.03-.02,.06-.04,.06-.04,.02-.01,.03-.04,.03-.06h0s-.02-.05-.04-.06c0,0-.13-.07-.15-.09,0-.01-.01-.03-.02-.05,.02-.02,.03-.03,.04-.05,.04-.01,.09-.01,.12,.01,.01,0,.32,.22,.78,.24,.33,.01,.67-.07,1.01-.25,.04-.02,.1-.02,.13,0,0,.02,.01,.03,.02,.04-.02,.02-.03,.03-.04,.05-.04,.02-.23,.1-.23,.1-.03,.01-.05,.03-.06,.05,0,0,0,0,0,.02,0,.01,0,.02,.02,.04m4.38,.04s0,.02,0,.03c-.02,.02-.05,.03-.08,.02-.05-.01-.11-.04-.17-.08-.03-.02-.09-.02-.14-.02l-.27,.05c-.05,.01-.1,.04-.1,.07v.06s-.03,.04-.07,.04c-.02,0-.03,0-.05-.02-.01-.02-.02-.03-.03-.04h0s-.05-.1-.11-.1c-.11,0-.23-.02-.34-.05-.06-.01-.12,0-.15,.04-.02,.03-.05,.06-.1,.08-.03,.01-.07,0-.09,0,0-.02,0-.02-.01-.03,.02-.02,.05-.05,.05-.05,0,0-.03,.02-.03,.02l.06-.04s.02-.02,.02-.04c0,0,0,0,0-.02,0-.02-.03-.04-.05-.05,0,0-.23-.1-.25-.11-.01-.02-.02-.02-.03-.04,0-.02,.02-.03,.03-.05,.03-.02,.08-.02,.12,0,.32,.17,.64,.25,.96,.23h0c.45-.02,.74-.22,.75-.23,.03-.02,.09-.03,.13,0,.02,.02,.02,.02,.03,.03-.01,.02-.02,.03-.03,.05-.03,.02-.13,.07-.13,.07-.03,.02-.03,.04-.03,.07,0,.03,0,.04,.11,.1m-2.46,.73c.09-.03,.15-.06,.19-.09,.03-.01,.06-.03,.06-.06,0,0,0-.04,.01-.07,.02,0,.03-.01,.05-.02,.02,0,.04,0,.06,0,.02,.01,.03,.03,.05,.04,0,0,0,.02,0,.03,0,.09-.13,.2-.35,.27-.36,.12-.92,.12-1.38-.25,0-.02-.01-.03-.02-.05,.02-.01,.02-.02,.03-.03,.03,0,.03,0,.05,0,.04,.01,.07,.02,.08,.03,.4,.31,.86,.31,1.16,.21m-1.11,9.27s-.02,.05-.06,.07c-.03,0-.06,0-.1,0,.1,0,.15-.02,.16-.07m-.04-5.57s0,0,0,0h0s0,0,0,0Z">
                </path>
                <path
                    d="M6.8,11.05c-.41-.56-1.04-1.22-1.57-1.63-.61-.46-1.25-.66-1.84-.75-.43-.06-.96-.06-1.31,.05-.26,.07-.55,.17-.71,.42-.22,.36,.03,.65,.53,.87,.04,.02,.04,.04-.02,.04-.62,.08-1.4,.39-1.57,.73-.14,.29-.07,.57,.15,.78,.2,.2,.52,.33,.94,.4,.59,.09,1.43,.08,2.39-.16,.06-.01,.11-.03,.16-.04,.35-.1,2.47-.67,2.84-.71Z">
                </path>
                <path
                    d="M29.2,11.05c.41-.56,1.04-1.22,1.57-1.63,.61-.46,1.24-.66,1.84-.75,.43-.06,.96-.06,1.31,.05,.26,.07,.55,.17,.71,.42,.23,.36-.03,.65-.53,.87-.04,.02-.04,.04,.02,.04,.62,.08,1.4,.39,1.57,.73,.14,.29,.06,.57-.15,.78-.2,.2-.52,.33-.94,.4-.59,.09-1.44,.08-2.39-.16-.06-.01-.11-.03-.16-.04-.35-.1-2.47-.67-2.84-.71Z">
                </path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#2581c7">
                <path
                    d="M18.55,19.49c.16-.12,.2-.15,.34-.24-.16-.66-.15-1.8,.68-2.45-1.46,0-2.73-.69-3.26-2.25-1.37-.76-1.91-1.78-2.06-2.78-1.21-.25-1.89-.82-2.23-1.48-.63,0-2.87-.07-3.5-2.12,.61,.7,1.34,1.37,3.24,1.34-.09-.52-.03-1.06,.09-1.53,.31,1.54,.6,2.68,2.35,3.03,.01-.57,.12-1.1,.22-1.52,.24,.98,.04,2.87,1.71,3.84,.03-.8,.28-2.05,1.29-3.46-3.58-4.38-9-4.27-11.55-1.17-1.49-.03-3.81-.84-3.74-.31,.55,.23,1.23,1.19,2.09,1.75,0,0,0,0,0,0,0,0,0,0,0,0,.67,.44,1.9,.64,2.69-.11,0,0-.46,1.54-2.88,.88-.41,.48-.62,1.14-.5,1.82,.11,.68,.51,1.24,1.05,1.57,0,0,0,0,0,0,.36,.22,.78,.34,1.22,.32-1.59-1.2-1.19-2.62-.88-2.95,.11,.5,.5,1.09,1.42,1.52,0,0-.47,.06-.99-.16,.03,.62,.82,1.51,1.52,1.84-.22,.1-.46,.17-.71,.21-.48,.08-.96,.03-1.39-.12,.57,1.66,1.85,3.24,3.36,4.6,.76,1.37,1.69,1.84,2.5,1.4,1.28-.69,1.71-1.93,.46-2.91-.08-.65-.03-1.13,.14-1.55,.22-.54,.4-.65,.34-1.5-.11-1.57-.38-2.23-2.11-3.51,2.43,.72,2.74,2.54,2.69,5.08,1.08,1.75,.69,3.9,.43,4.61-.23,.62-.3,.96-.41,1.41,.69,.84,2.31,1.66,3.69,2.82,.06-.77,.45-1.33,1.41-2.15-.26-.87-.32-2.59,1.28-3.77Zm-9.91-2.71s-.99-.48-1.2-1.12c-.12-.34,.07-.73,.45-.87,.38-.14,.79,.02,.91,.36,.22,.59-.17,1.63-.17,1.63ZM20.92,7.42c-2.58,1.54-3.46,3.45-3.58,3.81-.51,1.46-.41,2.82,.87,3.65,.63,.41,1.49,.4,2.09,0,.98-.65,1.02-2.04-.38-1.55,.13-.59,1.23-.68,1.7-.07,.4,.52,.49,1.24,.23,1.83-.2,.45-.63,.94-1.1,1.28-.85,.81-.92,1.6-.77,2.25,2.07-1.17,4.96-2.62,5.07-4.39,0-.01,0-.03,0-.04h0s0,.03,0,.04c.17,2.84-4.25,4.33-5.82,5.69-1.06,.92-.93,1.71-.72,2.42,2.22-1.55,6.57-3.8,8.5-6.45,1.02-1.4,1.41-3.57,.3-5.48,1.7,1.7,1.16,4.33,.23,5.78-1.89,2.96-7.27,5.7-9.18,7.35-1.77,1.53-1.17,3.04-.72,3.91,.04,.06,.07,.13,.1,.2,3-4.57,12.87-8.33,13.24-14.16,.38-5.89-5.28-8.64-10.05-6.07Zm3.3,5.9c-.13-1.86-.49-2.37-2.1-2.52,1.61-.15,1.97-.66,2.1-2.52,.13,1.86,.49,2.37,2.1,2.52-1.61,.15-1.97,.66-2.1,2.52ZM30.61,.5c-.2,2.88-.76,3.67-3.24,3.9,2.49,.23,3.04,1.02,3.24,3.9,.2-2.88,.76-3.67,3.24-3.9-2.49-.23-3.04-1.02-3.24-3.9ZM13.73,4.74l1.55,2.36h4.88l1.55-2.36c.23-.07,.39-.28,.39-.53,0-.31-.25-.56-.56-.56s-.56,.25-.56,.56c0,.18,.08,.33,.21,.44-.87,.97-2.5,1.75-3.24-.97,.22-.09,.38-.31,.38-.57,0-.34-.28-.62-.62-.62s-.62,.28-.62,.62c0,.26,.16,.48,.38,.57-.73,2.73-2.37,1.94-3.24,.97,.13-.1,.21-.26,.21-.44,0-.31-.25-.56-.56-.56s-.56,.25-.56,.56c0,.25,.17,.46,.39,.53Z">
                </path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#ffc20b">
                <path
                    d="M17.07,10.39c-.79-4.41-2.83-6.22-2.83-5.62,0,.64-.78,.8-1.24,.5-.6-.39-.64-1.16-.26-1.62,.83-1.02,4-.93,4.55,6.7,.02,.19-.19,.23-.22,.04Z">
                </path>
                <path
                    d="M18.33,10.39c.79-4.41,2.83-6.22,2.83-5.62,0,.64,.78,.8,1.24,.5,.6-.39,.64-1.16,.26-1.62-.83-1.02-4-.93-4.55,6.7-.02,.19,.19,.23,.22,.04Z">
                </path>
                <polygon
                    points="10.29 23.68 10.86 24.58 11.9 24.48 11.25 25.31 11.64 26.26 10.66 25.9 9.86 26.56 9.92 25.53 9.03 24.96 10.05 24.71 10.29 23.68">
                </polygon>
                <polygon
                    points="6.25 23.61 6.43 25.12 7.82 25.63 6.47 26.3 6.38 27.76 5.35 26.7 3.92 27.05 4.63 25.77 3.84 24.49 5.29 24.79 6.25 23.61">
                </polygon>
                <path
                    d="M28.59,3.83l-.95-.41-.17-1.63-1.05,1.22-1.6-.39,.84,1.42-.36,.57c.87-.24,1.76-.4,2.68-.62,.21-.05,.42-.11,.61-.17Z">
                </path>
                <polygon
                    points="29.35 .52 29.69 1.39 29.09 2.08 30.02 2.04 30.5 2.8 30.74 1.93 31.62 1.69 30.86 1.21 30.9 .28 30.21 .88 29.35 .52">
                </polygon>
                <path
                    d="M28.27,13.16c2.07-1.17,1.98-3.92,1.98-3.92,1.76-1.98,2.07-4.14,1.53-5.49-.49-1.22-1.49-.44-3.19,.08l.5,.22-1.46,.65-.19,1.59-1.03-1.2-1.61,.32,.5-.79c-2.65,.74-5.12,2.29-7.61,8.69C14.39,4.81,11.13,4.86,7.42,4c-2.09-.49-3.26-1.61-3.8-.25-.54,1.35-.23,3.51,1.53,5.49,0,0-.09,2.75,1.98,3.92,.13,1.72,1.74,2.47,3.33,2.74-.85,.34-1.3,1.04-1.47,1.59-.29,.99-.1,2.33-.19,3.36-.35-.1-.71-.17-1.05-.16-1.73,.04-2.13,1.76-.48,2.42,.84,.33,2.03,.26,2.94-.29,.53,.25,1.15,.45,1.86,.52,2.35,.23,4.12-1.05,4.47-2.96,.16-.86,.07-2.07-.72-2.88-.67-.69-2.1-.96-2.81,.11-.61,.91-.22,1.9,.41,2.1,.93,.31,1-.44,1.12-.14,.36,1.99-1.51,2.8-3.33,2.26,1.19-2.22-.82-4.92,2.44-6.02,0,0-3.37-1.05-3.83-5.22-.28-2.59,2.64-2.38,5.2,.51-2.9-1.75-4.47,1.05-2.98,2.61,.36,.38,1.53,.91,2.33,.03,.6-.66-.05-1.69-.41-1.67-.07,.34-.39,.39-.47,.11-.19-.63,1.15-.94,2.59,.31,.41,.62,.79,1.32,1.13,2.1-.1,.43-.16,.98-.16,1.52,0,1.16,.37,1.82,.65,1.82s.65-.67,.65-1.82c0-.54-.06-1.08-.17-1.52,.34-.78,.72-1.48,1.13-2.1,1.44-1.25,2.78-.94,2.59-.31-.08,.28-.41,.22-.47-.11-.35-.02-1.01,1.01-.41,1.67,.79,.88,1.96,.35,2.33-.03,1.49-1.56-.08-4.37-2.98-2.61,2.56-2.89,5.48-3.1,5.2-.51-.45,4.17-3.83,5.22-3.83,5.22,3.26,1.1,1.25,3.8,2.44,6.02-1.82,.54-3.7-.27-3.33-2.26,.12-.3,.19,.45,1.12,.14,.63-.21,1.02-1.2,.41-2.1-.72-1.07-2.15-.8-2.81-.11-.79,.81-.88,2.02-.72,2.88,.34,1.91,2.12,3.18,4.47,2.96,.71-.07,1.33-.27,1.86-.52,.92,.55,2.1,.62,2.94,.29,1.65-.66,1.25-2.38-.48-2.42-.34,0-.7,.06-1.05,.16-.09-1.03,.11-2.37-.19-3.36-.16-.55-.62-1.25-1.47-1.59,1.6-.27,3.2-1.01,3.33-2.74ZM7.57,22.42c-.77,.05-.84-.71-.19-.87,.35-.09,.73,.06,1.17,.32-.18,.32-.49,.52-.98,.55Zm1.06-9.72l-.73-.27-.6,.49,.05-.77-.67-.43,.76-.18,.19-.78,.43,.68,.78-.07-.49,.62,.29,.71Zm.76-3.41l-1.06-.39-.87,.71,.07-1.11-.97-.63,1.1-.27,.27-1.13,.62,.98,1.13-.1-.71,.9,.42,1.03Zm18.62,12.26c.65,.16,.58,.92-.19,.87-.49-.03-.79-.23-.98-.55,.44-.25,.82-.41,1.17-.32Zm-1.45-12.85l1.01-.25,.25-1.04,.57,.9,1.04-.1-.66,.83,.39,.95-.97-.36-.8,.65,.06-1.02-.89-.58Z">
                </path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#11be93">
                <path
                    d="M35.52,9.47c-.95,1.91-5.06,3.66-6.68,3.93,6.95-4.04,6.95-6.61,6.18-8.69-2.23,4.37-8.96,6.33-10.63,7.43-.68,.45-1.6,1.57-2.54,2.88l-.56-1.69,5.33-3.76h-6.59l-2.04-6.09-2.04,6.09h-6.59l5.33,3.76-.56,1.69c-.94-1.31-1.86-2.43-2.54-2.88-1.66-1.1-8.4-3.06-10.63-7.43C.2,6.79,.2,9.36,7.15,13.4c-1.61-.27-5.73-2.02-6.68-3.93-.89,2.08,.67,4.97,6.45,7.27-.72,.05-3.78-.49-4.84-1.2,0,1.26,.39,2.95,6.01,4.64-.67,.11-2.95-.16-3.62-.38-.11,.82,1.43,2.73,9.45,3.77-2.17-1.75-5-7.76-3.55-8.09,1.53-.35,7.62,9.07,7.62,9.07,0,0,6.09-9.42,7.62-9.07,1.45,.33-1.38,6.34-3.55,8.09,8.01-1.04,9.56-2.95,9.45-3.77-.67,.22-2.95,.49-3.62,.38,5.62-1.69,6.01-3.39,6.01-4.64-1.06,.71-4.12,1.26-4.84,1.2,5.79-2.29,7.34-5.19,6.45-7.27Zm-17.52,11.64s-1.19-2.08-2.61-4.25l.89-4.55s-1.23-.19-1.4-.2c-.14-.01-.56,.45-.56,.45-.04-.95,.45-1.41,.54-1.48,.06-.04,1.14-.14,1.14-.14l.58-.5c.19-.12,.34-.14,.75-.14h3.16l-1.03,.78,1.14,5.78c-1.43,2.18-2.61,4.25-2.61,4.25Z">
                </path>
                <path
                    d="M27.13,6.69l-.87,1.53c-.08,.15-.02,.21,.14,.14l1.72-.74,1.36,1.28c.13,.12,.21,.08,.18-.08l-.3-1.74,1.72-.74c.16-.07,.15-.15-.03-.18l-1.9-.34-.3-1.74c-.03-.17-.12-.18-.2-.04l-.87,1.53-1.9-.34c-.18-.03-.22,.04-.09,.16l1.36,1.28Z">
                </path>
                <path
                    d="M4.93,6.34l1.72,.74-.3,1.74c-.03,.17,.05,.2,.18,.08l1.36-1.28,1.72,.74c.16,.07,.22,0,.14-.14l-.87-1.53,1.36-1.28c.13-.12,.09-.19-.09-.16l-1.9,.34-.87-1.53c-.08-.15-.18-.13-.2,.04l-.3,1.74-1.9,.34c-.18,.03-.19,.11-.03,.18Z">
                </path>
                <path d="M16.67,11.14h.81l.53-.48c-.82-.02-1.33,.48-1.33,.48Z"></path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#8dbaff">
                <path
                    d="M25.96,9.67c1.06-1,1.97-2.16,2.69-3.44,.18-.31,.37-.65,.67-.87,.63-.45,1.39,.1,1.84,.55,.93,.94,1.23,2.38,1.02,3.66-.24,1.42-1.22,2.56-2.34,3.4-.17,.13-.33,.23-.52,.33,0,0,.99-.52,1.6-.94,.58-.4,.99-.61,1.6-.24,.78,.48,.58,2.35-.28,3.67-.89,1.36-2.4,2.64-3.06,2.82,0,0,.49-.11,.85-.33,.47-.28,.71-.56,.99-.33,.32,.27-.09,.8-.33,1.13-.23,.33-2.4,2.55-5.69,4.1-.03,.01-.08-.03-.05-.05,1.92-1.47,3.13-3.79,3.29-4.14,1.11-2.41,.87-4.47,.19-5.6-.76-1.25-2.39-1.82-3.81-1.46-1.09,.28-2.38,1.41-2.34,1.32,.14-.35,.35-.66,.59-.95,.59-.7,1.33-1.24,2.06-1.79,.35-.27,.7-.55,1.03-.85Zm-11.38,10.87,11.12-7c-.12,2.05-.21,2.2-1.47,2.39,1.26,.19,1.35,.34,1.47,2.39,.12-2.05,.21-2.2,1.47-2.39-1.26-.19-1.35-.34-1.47-2.39ZM12.24,2.83c-.15,2.61-.27,2.81-1.88,3.05,1.61,.24,1.73,.44,1.88,3.05,.15-2.61,.27-2.81,1.88-3.05-1.61-.24-1.73-.44-1.88-3.05Zm12.21,18.01c-.28,2.68-2.16,4.33-4,5.51-1.29,.82-1.55,1.41-1.55,1.41,0,0-1.94-1.98-4.52-3.15-3.1-1.41-6.21-2.92-7.57-4.24-1.36-1.32-1.88-2.07-1.74-2.49,.04-.13,.25-.29,.61-.05,.42,.28,1.22,.66,1.46,.66-1.91-.93-3.69-2.4-4.1-4.61-.13-.68-.09-1.54,.57-1.98,.56-.38,1.15,.08,1.32,.19,.28,.19,1.08,.82,2.07,1.22-.52-.19-1.96-1.46-2.16-1.69-.89-.98-1.28-2.4-1.06-3.7,.17-.97,.79-2.28,1.79-2.62,.83-.28,1.55,.32,2.06,.91,.76,.86,1.5,1.71,2.41,2.42,.86,.68,1.81,1.27,2.75,1.82,1.79,1.04,4.45,2.49,5.88,4.71,1.27,1.98,2.59,5.55,.09,9.32,0,0-.47-.8-2.54-1.98-1.67-.95-3.98-1.56-5.27-2.59-1.65-1.32-1.86-3.83-.42-5.27,.88-.88,2.15-1.04,3.31-.74,1.58,.4,2.79,1.89,2.52,3.56,0,0,.03-.49-.47-.8-.89-.56-1.74,.38-1.88,1.04-.25,1.18,.47,2.16,.89,2.49,1.03,.8,2.21,1.46,2.78,1.74,0,0,1.46-1.27,.89-3.91s-2.73-4.33-4.09-5.13c-1.36-.8-3.49-1.56-5.13-.52-1.55,.99-2.1,2.79-1.55,4.94,0,.02,.01,.04,.02,.06,.4,1.48,1.48,2.69,2.69,3.59,1.39,1.03,3.07,1.6,4.62,2.35,1.34,.65,2.77,1.4,3.73,2.56,.02,.03,1.09-1.2,1.18-1.32,.31-.44,.57-.9,.78-1.4,.38-.91,.57-1.88,.58-2.87,0-.6-.05-1.2-.15-1.79-.33-1.89-1.18-3.7-2.52-5.08-.68-.7-1.44-1.32-2.09-2.06-.84-.97-1.44-2.12-1.54-3.42-.17-2.02,.99-4.05,2.82-4.44,2.07-.44,5.15,1.43,3.78,3.73-.27,.46,.88,1.7,.88,1.7-.36,1.01-1.58-.2-2.06-1.43-.32-.82-1.2-1.47-2.11-1.31-1.05,.19-1.67,1.41-1.57,2.41,.12,1.17,1.03,1.98,1.87,2.69,1.07,.91,2.14,1.8,3.09,2.84,1.65,1.81,2.93,4.14,2.66,6.7Zm-4.18-15.1c-.06,.18-.09,.34-.06,.48,.03,.18,.14,.34,.25,.49,.11,.15,.13,.19,.24,.33,.04,.05,.07,.1,.11,.14,0,.03,.01,.05,.02,.08,.02,.06,.05,.11,.08,.16-.03-.11-.02-.23,0-.34,0-.01,0-.03,.01-.04,.02-.06,.04-.13,.08-.18,0,0,.01-.01,.02-.02,0,0,0,0,0,0,0,0,.03-.02,.03-.02l-.8-1.07ZM7.4,11.54c.09-1.55,.16-1.66,1.11-1.81-.95-.14-1.02-.26-1.11-1.81-.09,1.55-.16,1.66-1.11,1.81,.95,.14,1.02,.26,1.11,1.81ZM21.06,1.57c0-.17-.14-.31-.31-.31s-.31,.14-.31,.31c0,.08,.03,.15,.08,.2l-.42,.47c-.07,.09-.22,.04-.21-.07l-.05-.83c.15-.02,.27-.15,.27-.3,0-.17-.14-.31-.31-.31s-.31,.14-.31,.31c0,.1,.05,.2,.13,.25l-.4,.73c-.07,.1-.22,.07-.25-.05l-.26-1.12c.09-.05,.15-.15,.15-.26,0-.17-.14-.31-.31-.31s-.31,.14-.31,.31c0,.11,.06,.21,.15,.26l-.26,1.12c-.03,.12-.17,.15-.25,.05l-.4-.73c.08-.06,.13-.15,.13-.25,0-.17-.14-.31-.31-.31s-.31,.14-.31,.31c0,.16,.12,.28,.27,.3l-.05,.83c0,.11-.15,.16-.21,.07l-.42-.47c.05-.05,.08-.13,.08-.2,0-.17-.14-.31-.31-.31s-.31,.14-.31,.31,.13,.3,.29,.31l.54,1.49,.02,.06c.28-.15,.57-.26,.9-.34,.25-.06,.51-.09,.79-.09,.55,0,1.12,.12,1.63,.34l.54-1.47c.16,0,.29-.14,.29-.31Z">
                </path>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 28" style="fill:#f39800;stroke-width:0px">
                <path
                    d="M15.39,4.29c-.03.07-.04.18-.03.28.02.25.9,2.11,1.52,3.43l.75-.93c-.92-1.14-1.99-2.47-2.24-2.78Z">
                </path>
                <path
                    d="M22.9,14.43c0,1.58.91,2.87,2.07,2.99,1.92.15,6.52-3.83,7.92-6.34-3.81,1.48-8,2.07-11.2,1.7.06-.56.08-1.63-.44-2.38-.53-.77-1.43-.97-1.97-1.35-.05.09-.11.19-.13.22h0c-.04.08-.09.23-.03.36,1.2,2.63,1.07,6.54-1.13,11.4,3.78,0,6.36,3.53,8.31,6.7-.49-1.94-2-7.98-2.45-9.76-.58.54-.96,1.44-.96,2.46,0-1.66-1.01-3-2.25-3,1.24,0,2.25-1.34,2.25-3ZM20.76,10.95c-.16.14-.41.12-.57-.05-.16-.17-.16-.43,0-.57.16-.14.41-.12.57.05.16.17.16.43,0,.57Z">
                </path>
                <g style="fill:#ff8b00;stroke-width:0px">
                    <path
                        d="M20.25,3.26c-1.24,0-2.25-1.34-2.25-3,0,1.66-1.01,3-2.25,3,1.24,0,2.25,1.34,2.25,3,0-1.66,1.01-3,2.25-3Z">
                    </path>
                    <path
                        d="M20.65,4.57c0-.1,0-.2-.03-.28-.43.54-3.26,4.05-3.65,4.53-.45.55-1.59.67-2.22,1.58-.52.75-.5,1.82-.44,2.38-3.19.37-7.38-.22-11.2-1.7,2.84,5.11,10.96,5.62,14.61.62-2.27,4.24-5.9,4.78-9.94,4.14,3.52,3.25,8.82,1.59,10.5-2.92-.77,3.52-3.29,5.55-6.28,5.58-.23.91-1.77,7.07-2.32,9.24.73-1.19,1.56-2.43,2.5-3.52.54-.64,1.1-1.19,1.68-1.62.57-.45,1.19-.83,1.84-1.1,1.56-.64,4.29-6.61,3.29-10.69-.26-1.07-.63-1.21-.47-1.55.29-.61,2.08-4.32,2.12-4.68ZM15.81,10.9c-.16.17-.41.19-.57.05-.16-.14-.15-.4,0-.57.16-.17.41-.19.57-.05.16.14.15.4,0,.57Z">
                    </path>
                </g>
            </svg>
        </div>
        <div id="loading-text">NOW LOADING</div>
    </div>
    <img src="assets/img/IM@S_Series_15th_Anniversary_Song_Single_cover.jpg" alt="" id="bg" />
    <div id="bodyContainer">
        <h1><button id="title">各企划间综合对比</button></h1>
        <div id="legend">
            <a id="legend1" class="legend-item" href="765as.html"><span class="legend-color"
                    style="background:#f34f6d"></span>765AS</a>
            <a id="legend2" class="legend-item" href="cg.html"><span class="legend-color"
                    style="background:#2681c8"></span>CG</a>
            <a id="legend3" class="legend-item" href="ml.html"><span class="legend-color"
                    style="background:#ffc30b"></span>ML</a>
            <a id="legend4" class="legend-item" href="sidem.html"><span class="legend-color"
                    style="background:#0fbe94"></span>SideM</a>
            <a id="legend5" class="legend-item" href="sc.html"><span class="legend-color"
                    style="background:#8dbbff"></span>SC</a>
            <a id="legend6" class="legend-item" href="gk.html"><span class="legend-color"
                    style="background:#f39800"></span>GK</a>
            <a id="legend7" class="legend-item" href="others.html"><span class="legend-color"
                    style="background:#656a75"></span>Others</a>
            <a id="legend8" class="legend-item" href="all.html"><span class="legend-color"
                    style="background:#ff74b8"></span>ALL（不包含 SideM）</a>
        </div>
        <div id="chartWrapper">
            <div id="modeToggle">
                <button id="btn-value" class="active">数值</button>
                <button id="btn-ratio">占比</button>
            </div>
            <div id="valueMode">
                <div id="barChartContainer">
                    <div id="barChartBtns">
                        <button data-field="age" class="active">年龄</button>
                        <button data-field="height">身高(cm)</button>
                        <button data-field="weight">体重(kg)</button>
                        <button data-field="bust">胸围(cm)</button>
                        <button data-field="waist">腰围(cm)</button>
                        <button data-field="hip">臀围(cm)</button>
                        <button data-field="bmi">BMI</button>
                    </div>
                    <div id="barChart"></div>
                    <div id="barChartStaticBtns">
                        <button id="btn-mean" class="active">平均值</button>
                        <button id="btn-med">中值</button>
                    </div>
                </div>
            </div>
            <div id="ratioMode">
                <div id="pieChartContainer">
                    <div id="distBtns">
                        <button id="btn-age-dist" class="active">年龄</button>
                        <button id="btn-height-dist">身高</button>
                        <button id="btn-bust-dist">胸围</button>
                        <button id="btn-home-dist">出身地</button>
                        <button id="btn-hand-dist">惯用手</button>
                    </div>
                    <div id="distChart"></div>
                    <div id="prodBtns">
                        <button data-prod="All" id="pieBtnALL" class="active">ALL</button>
                        <button data-prod="THE IDOLM@STER" id="pieBtn765AS">765AS</button>
                        <button data-prod="CINDERELLA GIRLS" id="pieBtnCG">CG</button>
                        <button data-prod="MILLION LIVE!" id="pieBtnML">ML</button>
                        <button data-prod="SideM" id="pieBtnSideM">SideM</button>
                        <button data-prod="SHINY COLORS" id="pieBtnSC">SC</button>
                        <button data-prod="Gakuen" id="pieBtnGK">GK</button>
                        <button data-prod="Others" id="pieBtnOthers">Others</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="js/title.js"></script>
    <script src="js/echarts.min.js"></script>
    <script>
        fetch('data/c@st.min.json')
            .then(res => res.json())
            .then(data => {
                const known = {
                    "THE IDOLM@STER": "765AS",
                    "CINDERELLA GIRLS": "CG",
                    "MILLION LIVE!": "ML",
                    "SideM": "SideM",
                    "SHINY COLORS": "SC",
                    "Gakuen": "GK"
                };
                const colors = {
                    "765AS": "#f34f6d",
                    "CG": "#2681c8",
                    "ML": "#ffc30b",
                    "SideM": "#0fbe94",
                    "SC": "#8dbbff",
                    "GK": "#f39800",
                    "Others": "#656a75",
                    "All": "#ff74b8"
                };
                const prods = Object.keys(known);

                // ─────── 1. 初始化数据结构 ───────
                let stats = {}, bmiStats = {}, hometownCounts = {}, handedCounts = {};
                prods.forEach(p => {
                    stats[p] = { ages: [], heights: [], weights: [], busts: [], waists: [], hips: [] };
                    bmiStats[p] = [];
                    hometownCounts[p] = {};
                    handedCounts[p] = {};
                });
                stats['Others'] = { ages: [], heights: [], weights: [], busts: [], waists: [], hips: [] };
                bmiStats['Others'] = [];
                hometownCounts['Others'] = {};
                handedCounts['Others'] = {};
                // 用于“ALL（不含SideM）”
                let allAgesWithoutSideM = [], allHeightsWithoutSideM = [];

                data.forEach(prod => {
                    prod.staff.forEach(mem => {
                        if (mem.type === "事务人员" || mem.group === "非可育成偶像") return;
                        const key = prods.includes(prod.production) ? prod.production : 'Others';
                        const s = stats[key];

                        if (mem.age != null) {
                            s.ages.push(mem.age);
                            if (key !== 'SideM') allAgesWithoutSideM.push(mem.age);
                        }
                        if (mem.height != null) {
                            s.heights.push(mem.height);
                            if (key !== 'SideM') allHeightsWithoutSideM.push(mem.height);
                        }
                        if (mem.weight != null) s.weights.push(mem.weight);
                        if (Array.isArray(mem.three_sizes)) {
                            const [b, w, h] = mem.three_sizes;
                            if (b != null) s.busts.push(b);
                            if (w != null) s.waists.push(w);
                            if (h != null) s.hips.push(h);
                        }
                        if (typeof mem.height === 'number' && !isNaN(mem.height) && typeof mem.weight === 'number' && !isNaN(mem.weight)) {
                            bmiStats[key].push(mem.weight / ((mem.height / 100) ** 2));
                        }
                        if (mem.hometown != null) {
                            hometownCounts[key][mem.hometown] = (hometownCounts[key][mem.hometown] || 0) + 1;
                        }
                        if (mem.handedness != null) {
                            handedCounts[key][mem.handedness] = (handedCounts[key][mem.handedness] || 0) + 1;
                        }
                    });
                });

                // ─────── 2. 辅助函数 ───────
                function calcMean(arr) {
                    if (!arr.length) return 0;
                    return arr.reduce((a, b) => a + b, 0) / arr.length;
                }
                function calcMedian(arr) {
                    if (!arr.length) return 0;
                    const sorted = arr.slice().sort((a, b) => a - b);
                    const mid = Math.floor(sorted.length / 2);
                    return (sorted.length % 2 === 0)
                        ? (sorted[mid - 1] + sorted[mid]) / 2
                        : sorted[mid];
                }
                function calcStd(arr, mean) {
                    if (!arr.length) return 0;
                    const variance = arr.reduce((sum, v) => sum + (v - mean) ** 2, 0) / arr.length;
                    return Math.sqrt(variance);
                }

                // ─────── 3. 计算每个 production 的 avg / median / std ───────
                let avg = {}, medianData = {}, stdData = {};
                Object.entries(stats).forEach(([key, s]) => {
                    avg[key] = {
                        age: calcMean(s.ages),
                        height: calcMean(s.heights),
                        weight: calcMean(s.weights),
                        bust: calcMean(s.busts),
                        waist: calcMean(s.waists),
                        hip: calcMean(s.hips)
                    };
                    medianData[key] = {
                        age: calcMedian(s.ages),
                        height: calcMedian(s.heights),
                        weight: calcMedian(s.weights),
                        bust: calcMedian(s.busts),
                        waist: calcMedian(s.waists),
                        hip: calcMedian(s.hips)
                    };
                    stdData[key] = {
                        age: calcStd(s.ages, avg[key].age),
                        height: calcStd(s.heights, avg[key].height),
                        weight: calcStd(s.weights, avg[key].weight),
                        bust: calcStd(s.busts, avg[key].bust),
                        waist: calcStd(s.waists, avg[key].waist),
                        hip: calcStd(s.hips, avg[key].hip)
                    };
                });
                Object.entries(bmiStats).forEach(([key, arr]) => {
                    const m = calcMean(arr), md = calcMedian(arr), sd = calcStd(arr, m);
                    avg[key].bmi = m;
                    medianData[key].bmi = md;
                    stdData[key].bmi = sd;
                });

                // ─────── 4. “ALL” 合并 ───────
                const allKeysForBar = ['Others', ...prods.filter(p => p !== 'SideM')];
                const allKeysForPie = ['Others', ...prods];
                let combined = { ages: [], heights: [], weights: [], busts: [], waists: [], hips: [] };
                allKeysForBar.forEach(k => {
                    combined.ages = combined.ages.concat(stats[k].ages);
                    combined.heights = combined.heights.concat(stats[k].heights);
                    combined.weights = combined.weights.concat(stats[k].weights);
                    combined.busts = combined.busts.concat(stats[k].busts);
                    combined.waists = combined.waists.concat(stats[k].waists);
                    combined.hips = combined.hips.concat(stats[k].hips);
                });
                const meanAll = {
                    age: calcMean(combined.ages),
                    height: calcMean(combined.heights),
                    weight: calcMean(combined.weights),
                    bust: calcMean(combined.busts),
                    waist: calcMean(combined.waists),
                    hip: calcMean(combined.hips)
                };
                const medianAll = {
                    age: calcMedian(combined.ages),
                    height: calcMedian(combined.heights),
                    weight: calcMedian(combined.weights),
                    bust: calcMedian(combined.busts),
                    waist: calcMedian(combined.waists),
                    hip: calcMedian(combined.hips)
                };
                const stdAll = {
                    age: calcStd(combined.ages, meanAll.age),
                    height: calcStd(combined.heights, meanAll.height),
                    weight: calcStd(combined.weights, meanAll.weight),
                    bust: calcStd(combined.busts, meanAll.bust),
                    waist: calcStd(combined.waists, meanAll.waist),
                    hip: calcStd(combined.hips, meanAll.hip)
                };
                const allBmiArr = allKeysForBar.flatMap(k => bmiStats[k]);
                const mAllBmi = calcMean(allBmiArr), mdAllBmi = calcMedian(allBmiArr), sdAllBmi = calcStd(allBmiArr, mAllBmi);
                meanAll.bmi = mAllBmi;
                medianAll.bmi = mdAllBmi;
                stdAll.bmi = sdAllBmi;

                avg['All'] = meanAll;
                medianData['All'] = medianAll;
                stdData['All'] = stdAll;

                // ─────── 5. 柱状图相关 ───────
                const plotCats = [...prods.filter(p => p !== 'SideM'), 'Others', 'All'];
                const plotCatsBmi = [...prods, 'Others', 'All'];
                const labels = plotCats.map(p => known[p] || p);
                const labelsBmi = plotCatsBmi.map(p => known[p] || p);
                const fileMap = {
                    '765AS': '765as',
                    'CG': 'cg',
                    'ML': 'ml',
                    'SC': 'sc',
                    'GK': 'gk',
                    'Others': 'others',
                    'All': 'all',
                    'SideM': 'sidem'
                };

                const barFields = [
                    { field: 'age', title: '年龄', min: 14, useBmiCats: false },
                    { field: 'height', title: '身高(cm)', min: 155, useBmiCats: false },
                    { field: 'weight', title: '体重(kg)', min: 40, useBmiCats: false },
                    { field: 'bust', title: '胸围(cm)', min: 79, useBmiCats: false },
                    { field: 'waist', title: '腰围(cm)', min: 53, useBmiCats: false },
                    { field: 'hip', title: '臀围(cm)', min: 78, useBmiCats: false },
                    { field: 'bmi', title: 'BMI', min: 16, useBmiCats: true }
                ];

                let currentModeValue = 'mean';
                let currentFieldIdx = 0;

                function drawBarChart(field, title, min, useBmiCats) {
                    const chart = echarts.init(document.getElementById('barChart'));
                    const cats = useBmiCats ? plotCatsBmi : plotCats;
                    const xLabels = useBmiCats ? labelsBmi : labels;
                    const sourceData = currentModeValue === 'mean' ? avg : medianData;

                    chart.setOption({
                        title: { text: title, left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title' },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => {
                                const categoryKey = cats[params.dataIndex];
                                const sigma = stdData[categoryKey][field] || 0;
                                const modeName = currentModeValue === 'mean' ? 'μ' : 'Med';
                                return `${params.name}<br/>${params.marker}${modeName} = ${params.value.toFixed(2)}<br/>${params.marker}σ = ${sigma.toFixed(2)}`;
                            }
                        },
                        xAxis: { show: false, data: xLabels },
                        yAxis: { type: 'value', min },
                        series: [{
                            type: 'bar',
                            data: cats.map(p => ({
                                name: known[p] || p,
                                value: +(sourceData[p][field] || 0),
                                itemStyle: { color: colors[p in known ? known[p] : p] }
                            })),
                            barWidth: '50%',
                            label: {
                                show: true,
                                position: 'top',
                                fontWeight: 'bold',
                                formatter: params => params.value.toFixed(2)
                            }
                        }],
                    });
                    chart.on('click', e => {
                        window.location.href = fileMap[e.name] + '.html';
                    });
                }

                // 年龄~BMI 切换
                const barBtns = document.querySelectorAll('#barChartBtns button');
                function updateBar(idx) {
                    currentFieldIdx = idx;
                    barBtns.forEach((b, i) => {
                        b.classList.toggle('active', i === idx);
                    });
                    const { field, title, min, useBmiCats } = barFields[idx];
                    drawBarChart(field, title, min, useBmiCats);
                }
                barBtns.forEach((btn, idx) => {
                    btn.addEventListener('click', () => updateBar(idx));
                });

                // 平均值/中值 切换
                const btnMean = document.getElementById('btn-mean');
                const btnMedian = document.getElementById('btn-med');
                btnMean.addEventListener('click', () => {
                    currentModeValue = 'mean';
                    btnMean.classList.add('active');
                    btnMedian.classList.remove('active');
                    updateBar(currentFieldIdx);
                });
                btnMedian.addEventListener('click', () => {
                    currentModeValue = 'median';
                    btnMedian.classList.add('active');
                    btnMean.classList.remove('active');
                    updateBar(currentFieldIdx);
                });
                // 默认：年龄 + 平均值
                updateBar(0);

                // ─────── 6. 饼图（占比）计算 ───────
                function computeDistribution(prodKeys, distType) {
                    const result = [];
                    if (prodKeys.includes('All')) {
                        prodKeys = [...allKeysForPie];
                    }

                    if (distType === 'home') {
                        // 合并选中 production 的 hometownCounts
                        const combinedHome = {};
                        prodKeys.forEach(key => {
                            Object.entries(hometownCounts[key] || {}).forEach(([loc, cnt]) => {
                                combinedHome[loc] = (combinedHome[loc] || 0) + cnt;
                            });
                        });
                        Object.entries(combinedHome).forEach(([loc, cnt]) => {
                            if (cnt > 0) result.push({ name: loc, value: cnt });
                        });
                        result.sort((a, b) => b.value - a.value);
                        return result;
                    }
                    if (distType === 'hand') {
                        // 合并选中 production 的 handedCounts
                        const combinedHand = {};
                        prodKeys.forEach(key => {
                            Object.entries(handedCounts[key] || {}).forEach(([hand, cnt]) => {
                                combinedHand[hand] = (combinedHand[hand] || 0) + cnt;
                            });
                        });
                        Object.entries(combinedHand).forEach(([hand, cnt]) => {
                            if (cnt > 0) result.push({ name: hand, value: cnt });
                        });
                        return result;
                    }
                    // 年龄/身高
                    let allValues = [];
                    if (distType === 'age') {
                        prodKeys.forEach(key => {
                            allValues = allValues.concat(stats[key]?.ages || []);
                        });
                        const buckets = { '≤12岁': 0, '13-15岁': 0, '16-18岁': 0, '19-22岁': 0, '≥23岁': 0 };
                        allValues.forEach(age => {
                            if (age <= 12) buckets['≤12岁']++;
                            else if (age <= 15) buckets['13-15岁']++;
                            else if (age <= 18) buckets['16-18岁']++;
                            else if (age <= 22) buckets['19-22岁']++;
                            else buckets['≥23岁']++;
                        });
                        Object.entries(buckets).forEach(([name, value]) => {
                            if (value > 0) result.push({ name, value });
                        });
                        return result;
                    }
                    if (distType === 'height') {
                        prodKeys.forEach(key => {
                            allValues = allValues.concat(stats[key]?.heights || []);
                        });
                        const buckets = { '≤149cm': 0, '150-156cm': 0, '157-162cm': 0, '163-169cm': 0, '≥170cm': 0 };
                        allValues.forEach(h => {
                            if (h <= 149) buckets['≤149cm']++;
                            else if (h <= 156) buckets['150-156cm']++;
                            else if (h <= 162) buckets['157-162cm']++;
                            else if (h <= 169) buckets['163-169cm']++;
                            else buckets['≥170cm']++;
                        });
                        Object.entries(buckets).forEach(([name, value]) => {
                            if (value > 0) result.push({ name, value });
                        });
                        return result;
                    }
                    if (distType === 'bust') {
                        prodKeys.forEach(key => {
                            allValues = allValues.concat(stats[key]?.busts || []);
                        });
                        const buckets = { '≤72cm': 0, '73-78cm': 0, '79-83cm': 0, '84-89cm': 0, '≥90cm': 0 };
                        allValues.forEach(b => {
                            if (b <= 72) buckets['≤72cm']++;
                            else if (b <= 78) buckets['73-78cm']++;
                            else if (b <= 83) buckets['79-83cm']++;
                            else if (b <= 89) buckets['84-89cm']++;
                            else buckets['≥90cm']++;
                        });
                        Object.entries(buckets).forEach(([name, value]) => {
                            if (value > 0) result.push({ name, value });
                        });
                        return result;
                    }
                    return [];
                }

                const distChart = echarts.init(document.getElementById('distChart'));

                function getAgeOption(prodKeys) {
                    const ageData = computeDistribution(prodKeys, 'age');
                    return {
                        title: { text: '年龄', left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title', fontSize: 14 },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => `${params.name}<br/>${params.marker}${params.value}人<br/>${params.marker}${params.percent}%`
                        },
                        legend: {
                            type: 'scroll',
                            orient: 'vertical',
                            left: 10,
                            top: 20,
                            bottom: 20,
                            data: ageData.map(d => d.name)
                        },
                        label: {
                            show: true,
                            position: 'inside',
                            formatter: '{b}（{d}%）'
                        },
                        series: [{
                            type: 'pie',
                            radius: '50%',
                            data: ageData,
                            selectedMode: 'multiple',
                            selectedOffset: 30,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0,0,0,0.5)'
                                }
                            }
                        }]
                    };
                }

                function getHeightOption(prodKey) {
                    const heightData = computeDistribution(prodKey, 'height');
                    return {
                        title: { text: '身高(cm)', left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title', fontSize: 14 },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => `${params.name}<br/>${params.marker}${params.value}人<br/>${params.marker}${params.percent}%`
                        },
                        legend: {
                            type: 'scroll',
                            orient: 'vertical',
                            left: 10,
                            top: 20,
                            bottom: 20,
                            data: heightData.map(d => d.name)
                        },
                        label: {
                            show: true,
                            position: 'inside',
                            formatter: '{b}（{d}%）'
                        },
                        series: [{
                            type: 'pie',
                            radius: '50%',
                            data: heightData,
                            selectedMode: 'multiple',
                            selectedOffset: 30,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0,0,0,0.5)'
                                }
                            }
                        }]
                    };
                }
                function getBustOption(prodKey) {
                    const bustData = computeDistribution(prodKey, 'bust');
                    return {
                        title: { text: '胸围(cm)', left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title', fontSize: 14 },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => `${params.name}<br/>${params.marker}${params.value}人<br/>${params.marker}${params.percent}%`
                        },
                        legend: {
                            type: 'scroll',
                            orient: 'vertical',
                            left: 10,
                            top: 20,
                            bottom: 20,
                            data: bustData.map(d => d.name)
                        },
                        label: {
                            show: true,
                            position: 'inside',
                            formatter: '{b}（{d}%）'
                        },
                        series: [{
                            type: 'pie',
                            radius: '50%',
                            data: bustData,
                            selectedMode: 'multiple',
                            selectedOffset: 30,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0,0,0,0.5)'
                                }
                            }
                        }]
                    };
                }

                function getHomeOption(prodKey) {
                    const homeData = computeDistribution(prodKey, 'home');
                    return {
                        title: { text: '出身地', left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title', fontSize: 14 },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => `${params.name}<br/>${params.marker}${params.value}人<br/>${params.marker}${params.percent}%`
                        },
                        legend: {
                            type: 'scroll',
                            orient: 'vertical',
                            left: 10,
                            top: 20,
                            bottom: 20,
                            data: homeData.map(d => d.name)
                        },
                        label: {
                            show: true,
                            position: 'inside',
                            formatter: '{b}（{d}%）'
                        },
                        series: [{
                            type: 'pie',
                            radius: ['50%', '70%'],
                            data: homeData,
                            selectedMode: 'single',
                            selectedOffset: 0,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0,0,0,0.5)'
                                }
                            }
                        }]
                    };
                }

                function getHandOption(prodKey) {
                    const handData = computeDistribution(prodKey, 'hand');
                    return {
                        title: { text: '惯用手', left: 'center', top: 20 },
                        textStyle: { fontFamily: 'font-title', fontSize: 14 },
                        tooltip: {
                            trigger: 'item',
                            formatter: params => `${params.name}<br/>${params.marker}${params.value}人<br/>${params.marker}${params.percent}%`
                        },
                        legend: {
                            orient: 'vertical',
                            top: 16,
                            left: 10,
                            data: handData.map(d => d.name)
                        },
                        label: {
                            show: true,
                            position: 'inside',
                            formatter: '{b}（{d}%）'
                        },
                        series: [{
                            type: 'pie',
                            radius: '50%',
                            data: handData,
                            selectedMode: 'multiple',
                            selectedOffset: 30,
                            emphasis: {
                                itemStyle: {
                                    shadowBlur: 10,
                                    shadowOffsetX: 0,
                                    shadowColor: 'rgba(0,0,0,0.5)'
                                }
                            }
                        }]
                    };
                }

                // ─────── 7. 占比模式按钮逻辑 ───────
                let currentProds = ['All'];
                let currentDist = 'age';

                const prodBtns = document.querySelectorAll('#prodBtns button');
                const allButton = Array.from(prodBtns).find(b => b.getAttribute('data-prod') === 'All');
                const nonAllButtons = Array.from(prodBtns).filter(b => b.getAttribute('data-prod') !== 'All');

                prodBtns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const key = btn.getAttribute('data-prod');
                        if (key === 'All') {
                            // 如果点击 ALL，那么取消其余按钮，并仅保留 ALL
                            prodBtns.forEach(b => b.classList.remove('active'));
                            allButton.classList.add('active');
                            currentProds = ['All'];
                        } else {
                            // 切换当前按钮的 active 状态
                            const isActive = btn.classList.toggle('active');
                            // 如果之前 ALL 是选中的，则取消 ALL
                            if (allButton.classList.contains('active')) {
                                allButton.classList.remove('active');
                                currentProds = [];
                            }
                            // 更新 currentProds 列表
                            if (isActive) {
                                currentProds.push(key);
                            } else {
                                currentProds = currentProds.filter(k => k !== key);
                            }
                            if (currentProds.length === 0) {
                                prodBtns.forEach(b => b.classList.remove('active'));
                                allButton.classList.add('active');
                                currentProds = ['All'];
                            }
                            // 如果所有非ALL 按钮都已选中，则改为只选中 ALL
                            const allNonAllSelected = nonAllButtons.every(b => b.classList.contains('active'));
                            if (allNonAllSelected) {
                                nonAllButtons.forEach(b => b.classList.remove('active'));
                                allButton.classList.add('active');
                                currentProds = ['All'];
                            }
                        }
                        renderDistChart();
                    });
                });

                const distBtns = document.querySelectorAll('#distBtns button');
                function clearDistActive() {
                    distBtns.forEach(b => b.classList.remove('active'));
                }
                function renderDistChart() {
                    let option;
                    switch (currentDist) {
                        case 'age':
                            option = getAgeOption(currentProds);
                            break;
                        case 'height':
                            option = getHeightOption(currentProds);
                            break;
                        case 'home':
                            option = getHomeOption(currentProds);
                            break;
                        case 'hand':
                            option = getHandOption(currentProds);
                            break;
                        case 'bust':
                            option = getBustOption(currentProds);
                            break;
                    }
                    distChart.setOption(option);
                }

                document.getElementById('btn-age-dist').addEventListener('click', () => {
                    clearDistActive();
                    document.getElementById('btn-age-dist').classList.add('active');
                    currentDist = 'age';
                    renderDistChart();
                });
                document.getElementById('btn-height-dist').addEventListener('click', () => {
                    clearDistActive();
                    document.getElementById('btn-height-dist').classList.add('active');
                    currentDist = 'height';
                    renderDistChart();
                });
                document.getElementById('btn-home-dist').addEventListener('click', () => {
                    clearDistActive();
                    document.getElementById('btn-home-dist').classList.add('active');
                    currentDist = 'home';
                    renderDistChart();
                });
                document.getElementById('btn-hand-dist').addEventListener('click', () => {
                    clearDistActive();
                    document.getElementById('btn-hand-dist').classList.add('active');
                    currentDist = 'hand';
                    renderDistChart();
                });

                document.getElementById('btn-bust-dist').addEventListener('click', () => {
                    clearDistActive();
                    document.getElementById('btn-bust-dist').classList.add('active');
                    currentDist = 'bust';
                    renderDistChart();
                });

                // 初始化：默认“年龄分布”
                renderDistChart();

                // ─────── 8. 模式切换 ───────
                const btnValueMode = document.getElementById('btn-value');
                const btnRatioMode = document.getElementById('btn-ratio');
                const valueModeDiv = document.getElementById('valueMode');
                const ratioModeDiv = document.getElementById('ratioMode');

                btnValueMode.addEventListener('click', () => {
                    btnValueMode.classList.add('active');
                    btnRatioMode.classList.remove('active');
                    valueModeDiv.style.display = 'block';
                    ratioModeDiv.style.display = 'none';
                });
                btnRatioMode.addEventListener('click', () => {
                    btnRatioMode.classList.add('active');
                    btnValueMode.classList.remove('active');
                    valueModeDiv.style.display = 'none';
                    ratioModeDiv.style.display = 'block';
                });
            });
    </script>
    <script src="js/loading.js"></script>
</body>

</html>